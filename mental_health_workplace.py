# -*- coding: utf-8 -*-
"""Mental_Health_Workplace.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1dS7-WSu5ZwiRLRm2mWRtPYpC81AmLDGj

ğŸ“Š **Mental Health in the Workplace - EDA Project**
## A Data Analyst's Exploration into Employee Well-being

Welcome! In this notebook, we explore a dataset focused on **mental health in workplace environments**.  
As data analysts, it's our goal to uncover insights that can help **companies foster healthier, more supportive workspaces**.

# 1. Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙÙ‡Ù… Ù‡ÙŠÙƒÙ„Ù‡Ø§ - Data Loading & Structure
"""

import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
import plotly.express as px

df = pd.read_csv('/content/mental_health0.csv' , sep=";" )
df.head().T

df.info()
df.shape

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© ÙˆØ§Ù„Ù…ÙƒØ±Ø±Ø©

missing_values = df.isnull().sum()
duplicated_rows = df.duplicated().sum()

print(" Ø¹Ø¯Ø¯ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© ÙÙŠ ÙƒÙ„ Ø¹Ù…ÙˆØ¯:")
print(missing_values)

print("\n Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ù…ÙƒØ±Ø±Ø© ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:")
print(duplicated_rows)

"""# 2. ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØªØ¬Ù‡ÙŠØ²Ù‡Ø§ - Data Cleaning & Preparation






"""

# ØªØ¹ÙˆÙŠØ¶ Ø§Ù„Ù‚ÙŠÙ…Ù‡ Ø§Ù„Ù†ØµÙŠØ© Ø§Ù„Ù†Ø§Ù‚ØµØ© Ø¨Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ÙƒØ«Ø± ØªÙƒØ±Ø§Ø±Ù‹Ø§
df['Gender'].fillna(df['Gender'].mode()[0], inplace=True)
# ØªØ¹ÙˆÙŠØ¶ Ø¨Ø§Ù„Ù…ØªÙˆØ³Ø·
df['SleepHours'].fillna(df['SleepHours'].mean(), inplace=True)
# ØªØ¹ÙˆÙŠØ¶ Ø¨Ø§Ù„ÙˆØ³ÙŠØ·
df['CareerGrowthScore'].fillna(df['CareerGrowthScore'].median(), inplace=True)

# Ø­Ø°Ù Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ù…ÙƒØ±Ø±Ø©
df.drop_duplicates(inplace=True)
print(": Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ†Ø¸ÙŠÙØŒ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© ÙÙŠ ÙƒÙ„ Ø¹Ù…ÙˆØ¯ ")
print(df.isnull().sum())
print(": Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ†Ø¸ÙŠÙØŒ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…ÙƒØ±Ø±Ù‡ ÙÙŠ ÙƒÙ„ ØµÙ ")
print(df.duplicated().sum())

"""# 3.  Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙˆØµÙÙŠ - Descriptive Analysis

"""

# ÙˆØµÙ Ø¥Ø­ØµØ§Ø¦ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ© (mean, median, std)
df.drop(columns=['EmployeeID']).describe().T

# ØªØ­Ù„ÙŠÙ„ ØªÙƒØ±Ø§Ø±ÙŠ
import matplotlib.pyplot as plt
import numpy as np

# Ø§Ø®ØªØ± Ø¹Ù…ÙˆØ¯ÙŠÙ† ÙÙ‚Ø·
key_columns = ['Department', 'SalaryRange']

# Ø¥Ù†Ø´Ø§Ø¡ 1 ØµÙ Ã— 2 Ø£Ø¹Ù…Ø¯Ø©
fig, axes = plt.subplots(1, 2, figsize=(12, 6))

for i, col in enumerate(key_columns):
    counts = df[col].value_counts(dropna=False)
    sizes = counts.values
    labels = counts.index
    total = sizes.sum()

    # Ø±Ø³Ù… Ø§Ù„Ø¯Ø§Ø¦Ø±Ø©
    wedges, _ = axes[i].pie(
        sizes,
        labels=None,
        startangle=90,
        colors=plt.cm.Pastel2.colors
    )

    # Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© + Ø§Ø³Ù… Ø§Ù„ÙØ¦Ø©
    for j, wedge in enumerate(wedges):
        angle = (wedge.theta2 + wedge.theta1) / 2
        x = np.cos(np.deg2rad(angle)) * 1.2
        y = np.sin(np.deg2rad(angle)) * 1.2
        pct = f'{(sizes[j]/total)*100:.1f}%'
        axes[i].text(x, y, pct, ha='center', va='bottom', fontsize=9, color='Blue')
        axes[i].text(x, y - 0.1, str(labels[j]), ha='center', va='top', fontsize=8, color='black')

    axes[i].set_title(col, fontsize=12)

plt.suptitle('Key Feature Distributions (Pie Charts)', fontsize=14)
plt.tight_layout(rect=[0, 0, 1, 0.93])
plt.show()

#   ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…Ø³ØªÙ…Ø±Ø© (Categorical Variables)
# ØªÙˆØ²ÙŠØ¹ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù†ÙˆÙ…ØŒ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„ØŒ
continuous_cols = ['SleepHours', 'WorkHoursPerWeek']

plt.figure(figsize=(16, 4))
for i, col in enumerate(continuous_cols):
    plt.subplot(1, 3, i+1)
    df[col].hist(bins=20, color='steelblue', edgecolor='black')
    plt.title(f'Distribution of {col}')
    plt.xlabel(col)
    plt.ylabel('Count')
plt.tight_layout()
plt.show()

"""# 4.  Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³ØªÙƒØ´Ø§ÙÙŠ - Exploratory Data Analysis

"""

# ØªØµÙÙŠØ© Ø´Ø±Ø·ÙŠØ© Ù„Ù„Ø¥Ø³ØªÙƒØ´Ø§Ù
# and
filtered1 = df[(df["JobRole"] == "IT Admin") & (df["HasMentalHealthSupport"] == "Yes") & (df["BurnoutLevel"] >= 7)]
print(f"\n Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ Ø§Ù„ØªÙŠ ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ø´Ø±ÙˆØ·: {len(filtered1)}")
# or
filtered2 =df[(df["HasMentalHealthSupport"] == "Yes") | (df["HasTherapyAccess"] == "Yes")]
print(f"\n Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ Ø§Ù„ØªÙŠ ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ø´Ø±ÙˆØ·: {len(filtered2)}")

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…ØªØ·Ø±ÙØ©
numeric_df = df.drop(columns=["EmployeeID"]).select_dtypes(include=['int64', 'float64'])
plt.figure(figsize=(14, 6))
sns.boxplot(data=numeric_df)
plt.title("Outliers")
plt.xticks(rotation=45)
plt.show()

# 1. Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµØ­ÙŠ ÙˆØ§Ù„Ù†ÙØ³ÙŠ
health_df = df[[
    'SleepHours',
    'PhysicalActivityHrs',
    'StressLevel',
    'BurnoutLevel',
    'HasTherapyAccess',
    'HasMentalHealthSupport',
    'MentalHealthDaysOff'
]].copy()

# ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†ØµÙˆØµ Ø¥Ù„Ù‰ Ø£Ø±Ù‚Ø§Ù…
health_df['HasTherapyAccess'] = health_df['HasTherapyAccess'].map({'Yes': 1, 'No': 0})
health_df['HasMentalHealthSupport'] = health_df['HasMentalHealthSupport'].map({'Yes': 1, 'No': 0})

# Ø­Ø³Ø§Ø¨ Ù…ØµÙÙˆÙØ© Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø·
corr_matrix = health_df.corr()

# Ø±Ø³Ù… Heatmap
plt.figure(figsize=(10, 8))
sns.heatmap(corr_matrix, annot=True, cmap='PuBu', center=0, fmt=".2f", linewidths=0.5)
plt.title('Correlation Between Health & Mental Wellness Features')
plt.xticks(rotation=45)
plt.yticks(rotation=0)
plt.tight_layout()
plt.show()

#  2.ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠÙ‡ ÙˆØ§Ù„Ø§Ø¯Ø§Ø¡
# ØªØµÙ†ÙŠÙ Manager Support Ø¥Ù„Ù‰ ÙØ¦Ø§Øª: Low, Medium, High
df['ManagerSupportLevel'] = pd.cut(df['ManagerSupportScore'],
                                   bins=[0, 4, 7, 10],
                                   labels=['Low', 'Medium', 'High'])

# ØªØµÙ†ÙŠÙ Career Growth Ø¥Ù„Ù‰ ÙØ¦Ø§Øª
df['CareerGrowthLevel'] = pd.cut(df['CareerGrowthScore'],
                                 bins=[0, 4, 7, 10],
                                 labels=['Low', 'Medium', 'High'])
# Ø¯Ù…Ø¬ Ø§Ù„ÙØ¦ØªÙŠÙ† ÙÙŠ Ø¹Ù…ÙˆØ¯ ÙˆØ§Ø­Ø¯
df['Support_and_Growth'] = df['ManagerSupportLevel'].astype(str) + ' / ' + df['CareerGrowthLevel'].astype(str)

# Ø­Ø°Ù Ø§Ù„ØµÙÙˆÙ Ø§Ù„ØªÙŠ ÙÙŠÙ‡Ø§ Ù‚ÙŠÙ… Ù…ÙÙ‚ÙˆØ¯Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªØµÙ†ÙŠÙ
plot_df = df.dropna(subset=['Support_and_Growth', 'JobSatisfaction'])

# Ø±Ø³Ù… Boxplot
plt.figure(figsize=(12, 6))
sns.boxplot(data=plot_df,
            x='Support_and_Growth',
            y='JobSatisfaction',
            palette='coolwarm')

# ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ù…Ø­Ø§ÙˆØ±
plt.title('Job Satisfaction Based on Manager Support and Career Growth', fontsize=14)
plt.xlabel('Manager Support / Career Growth')
plt.ylabel('Job Satisfaction')
plt.xticks(rotation=45)
plt.grid(True, linestyle='--', alpha=0.3)
plt.tight_layout()
plt.show()

"""# 5.  Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠ - Statistical Analysis

"""

# 3. ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¹Ù…Ù„ ÙˆØ§Ù„Ø±Ø§Ø­Ù‡
import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd

# ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù‚ÙŠÙ… Ø¥Ù„Ù‰ ÙØ¦Ø§Øª
def categorize_stress(stress):
    if stress <= 3:
        return 'Low'
    elif 4 <= stress <= 7:
        return 'Medium'
    else:
        return 'High'

def categorize_work_life_balance(balance):
    if balance <= 3:
        return 'Low'
    elif 4 <= balance <= 7:
        return 'Medium'
    else:
        return 'High'

# ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙØ¦Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©
df['StressCategory'] = df['StressLevel'].apply(categorize_stress)
df['WorkLifeBalanceCategory'] = df['WorkLifeBalanceScore'].apply(categorize_work_life_balance)

# Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø´ÙƒÙ„ Ù„Ø§Ø­ØªÙˆØ§Ø¡ Ø§Ù„Ø±Ø³Ù…ÙŠÙ† Ø¨Ø´ÙƒÙ„ Ù…Ù†ÙØµÙ„
fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# Ø±Ø³Ù… Count Plot Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙˆØªØ± Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„ÙˆØ¸ÙŠÙØ© (Ø±Ø³Ù… Ø£ÙˆÙ„)
sns.countplot(x='JobRole', hue='StressCategory', data=df, ax=axes[0], palette="coolwarm")
axes[0].set_title('Stress Level by Job Role', fontsize=16)
axes[0].set_xlabel('Job Role', fontsize=12)
axes[0].set_ylabel('Count', fontsize=12)
axes[0].tick_params(axis='x', rotation=45)

# Ø±Ø³Ù… Count Plot Ù„Ø¹Ø±Ø¶ ØªÙˆØ§Ø²Ù† Ø§Ù„Ø­ÙŠØ§Ø© ÙˆØ§Ù„Ø¹Ù…Ù„ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„ÙˆØ¸ÙŠÙØ© (Ø±Ø³Ù… Ø«Ø§Ù†ÙŠ)
sns.countplot(x='JobRole', hue='WorkLifeBalanceCategory', data=df, ax=axes[1], palette="YlGnBu")
axes[1].set_title('Work Life Balance by Job Role', fontsize=16)
axes[1].set_xlabel('Job Role', fontsize=12)
axes[1].set_ylabel('Count', fontsize=12)
axes[1].tick_params(axis='x', rotation=45)

# Ø¶Ø¨Ø· Ø§Ù„Ù…Ø³Ø§ÙØ§Øª Ø¨ÙŠÙ† Ø§Ù„Ø±Ø³Ù…ÙŠÙ†
plt.tight_layout()

# Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ù…
plt.show()

# 4. ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ù…Ø§Øª Ø§Ù„ÙˆØ¸ÙŠÙÙŠÙ‡ ÙˆÙ…Ø¯Ù‰ ØªØ§Ø«ÙŠØ±Ù‡Ø§
#ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø¹Ù…Ø± ÙˆØ§Ù„Ø®Ø¨Ø±Ù‡ Ø§Ù„Ù‰ ÙØ¦Ø§Øª
df['AgeGroup'] = pd.cut(df['Age'], bins=[18, 25, 35, 45, 60], labels=['18-25', '25-35', '36-45', '46-60'])
df['ExperienceGroup'] = pd.cut(df['YearsAtCompany'], bins=[0, 2, 5, 10, 50], labels=['0-2', '3-5', '6-10', '+10'])

# ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ© Ø¥Ù„Ù‰ Ù†ØµÙˆØµ Ù‚Ø¨Ù„ Ø¯Ù…Ø¬Ù‡Ø§
df['WorkProfile'] = (
    df['Gender'].astype(str) + ' | ' +
    df['AgeGroup'].astype(str) + ' | ' +
    df['SalaryRange'].astype(str) + ' | ' +
    df['ExperienceGroup'].astype(str) + ' | ' +
    df['Department'].astype(str)
)

# Ø­Ø³Ø§Ø¨ Ù…ØªÙˆØ³Ø· Ø§Ù„Ø¥Ø±Ù‡Ø§Ù‚ ÙˆØ§Ù„Ø±Ø¶Ø§ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ Ù„ÙƒÙ„ Ø¨Ø±ÙˆÙØ§ÙŠÙ„
profile_summary = df.groupby('WorkProfile')[['BurnoutLevel', 'JobSatisfaction']].mean().round(2)

# Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø£Ø¹Ù„Ù‰ 20 Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ù…Ù† Ø­ÙŠØ« Ø§Ù„Ø¥Ø±Ù‡Ø§Ù‚
top_profiles_df = profile_summary.sort_values(by='BurnoutLevel', ascending=False).head(20).reset_index()

# ÙØµÙ„ WorkProfile Ø¥Ù„Ù‰ Ø£Ø¹Ù…Ø¯Ø© Ù…Ù†ÙØµÙ„Ø©
profile_parts = top_profiles_df['WorkProfile'].str.split(' \| ', expand=True)
profile_parts.columns = ['Gender', 'AgeGroup', 'SalaryRange', 'ExperienceGroup', 'Department']

# Ø¯Ù…Ø¬ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ù…Ø¹ Ø§Ù„Ù‚ÙŠÙ…
top_profiles_df = pd.concat([profile_parts, top_profiles_df[['BurnoutLevel', 'JobSatisfaction']]], axis=1)

# Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙˆØ¯ Ù„ØªØ³Ù‡ÙŠÙ„ Ù‚Ø±Ø§Ø¡Ù‡ Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„Ø§Øª'Person'
top_profiles_df['Person'] = ['Person ' + str(i) for i in range(1, len(top_profiles_df) + 1)]
cols = ['Person'] + [col for col in top_profiles_df.columns if col != 'Person']
top_profiles_df = top_profiles_df[cols]

# Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
print(f" Ø£Ø¹Ù„Ù‰ {len(top_profiles_df)} Ø¨Ø±ÙˆÙØ§ÙŠÙ„Ø§Øª Ù…Ù† Ø­ÙŠØ« Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¥Ø±Ù‡Ø§Ù‚ Ù…Ø¹ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø±Ø¶Ø§ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ:\n")
print(top_profiles_df.to_string(index=False))


plt.figure(figsize=(12, 9))  # Ù‚Ù„Ù„Øª Ø§Ù„Ø¹Ø±Ø¶ Ø´ÙˆÙŠØ© ÙˆØ§Ù„Ø§Ø±ØªÙØ§Ø¹ Ø²Ø¯ØªÙ‡ Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ø®Ø§Øµ

# Ù†Ù‚Ø§Ø· Ø§Ù„Ø¥Ø±Ù‡Ø§Ù‚ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£Ø´Ø®Ø§Øµ
sns.scatterplot(
    data=top_profiles_df,
    x='BurnoutLevel',
    y='Person',
    s=150,
    color='red',
    label='Burnout Level'
)

# Ù†Ù‚Ø§Ø· Ø§Ù„Ø±Ø¶Ø§ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£Ø´Ø®Ø§Øµ
sns.scatterplot(
    data=top_profiles_df,
    x='JobSatisfaction',
    y='Person',
    s=150,
    color='blue',
    label='Job Satisfaction'
)

# Ø®Ø·ÙˆØ· Ø±Ø¨Ø· Ø¨ÙŠÙ† Ø§Ù„Ù†Ù‚Ø·ØªÙŠÙ† Ù„ÙƒÙ„ Ø´Ø®Øµ
for _, row in top_profiles_df.iterrows():
    plt.plot([row['JobSatisfaction'], row['BurnoutLevel']],
             [row['Person'], row['Person']],
             color='gray', linestyle='--', alpha=0.5)

plt.title(f'Burnout vs Job Satisfaction for Top {len(top_profiles_df)} Exhausted Work Profiles', fontsize=16)
plt.xlabel('Score')
plt.ylabel('Person')
plt.legend()
plt.grid(axis='x', linestyle='--', alpha=0.5)
plt.xlim(0, 10)

plt.tight_layout(pad=0)

plt.show()

"""# 6.  Ø§Ù„ØªØµÙˆØ± Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ - Data Visualization

"""

def categorize_support(score):
    if score <= 3:
        return 'Low'
    elif score <= 7:
        return 'Medium'
    else:
        return 'High'

df['ManagerSupportLevel'] = df['ManagerSupportScore'].apply(categorize_support)

pivot_table = df.groupby(['HasMentalHealthSupport', 'ManagerSupportLevel'])['BurnoutLevel'].mean().reset_index()

# Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠØ§Øª Ù„Ù„Ù…ØªÙˆØ³Ø·Ø§Øª
q1 = pivot_table['BurnoutLevel'].quantile(0.25)
q3 = pivot_table['BurnoutLevel'].quantile(0.75)

def categorize_burnout_quantiles(avg_score):
    if avg_score <= q1:
        return 'Low'
    elif avg_score <= q3:
        return 'Medium'
    else:
        return 'High'

pivot_table['BurnoutCategory'] = pivot_table['BurnoutLevel'].apply(categorize_burnout_quantiles)

pivot_pivot = pivot_table.pivot(index='HasMentalHealthSupport', columns='ManagerSupportLevel', values='BurnoutCategory')

category_to_num = {'Low': 0, 'Medium': 1, 'High': 2}
pivot_numeric = pivot_table.copy()
pivot_numeric['BurnoutNum'] = pivot_numeric['BurnoutCategory'].map(category_to_num)
pivot_numeric_pivot = pivot_numeric.pivot(index='HasMentalHealthSupport', columns='ManagerSupportLevel', values='BurnoutNum')

plt.figure(figsize=(8, 5))
sns.heatmap(pivot_numeric_pivot, annot=pivot_pivot, fmt='', cmap='YlGnBu', linewidths=0.5, cbar_kws={'label': 'Burnout Category (0=Low,2=High)'})

plt.title('Impact of Mental Health Support & Manager Support on Burnout Categories', fontsize=14)
plt.xlabel('Manager Support Level')
plt.ylabel('Has Mental Health Support')
plt.yticks([0.5, 1.5], ['No', 'Yes'], rotation=0)
plt.tight_layout()
plt.show()

# Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ØªÙˆØ³Ø· Ù„ÙƒÙ„ Ø¯ÙˆÙ„Ø©
burnout_by_country = df.groupby("Country")["BurnoutLevel"].mean().reset_index()
burnout_by_country.columns = ['Country', 'AverageBurnout']

# ØªÙ‚Ø³ÙŠÙ… Burnout Ø¥Ù„Ù‰ 6 ÙØ¦Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªÙˆØ²ÙŠØ¹ (Quantiles)
quantile_bins = pd.qcut(
    burnout_by_country['AverageBurnout'],
    q=6,
    labels=["Very Low", "Low", "Moderate", "Medium High", "High", "Very High"]
)

burnout_by_country["BurnoutCategory"] = quantile_bins

# Ø£Ù„ÙˆØ§Ù† Ù…Ù†Ø§Ø³Ø¨Ø© Ù„ÙƒÙ„ ÙØ¦Ø©
category_colors = {
    "Very Low": "#c6dbef",
    "Low": "#9ecae1",
    "Moderate": "#6baed6",
    "Medium High": "#4292c6",
    "High": "#2171b5",
    "Very High": "#084594"
}

# Ø±Ø³Ù… Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©
fig = px.choropleth(
    burnout_by_country,
    locations="Country",
    locationmode="country names",
    color="BurnoutCategory",
    color_discrete_map=category_colors,
    hover_name="Country"
)

# Ø¶Ø¨Ø· Ø§Ù„ØªØµÙ…ÙŠÙ…
fig.update_layout(
    geo=dict(
        showframe=False,
        projection_type='natural earth'
    ),
    title=dict(
        text="Burnout Levels by Country (Quantile-Based Categories)",
        x=0.5,
        y=0.92,
        xanchor='center',
        yanchor='top',
        font=dict(size=18)
    ),
    legend_title="Burnout Category",
    legend=dict(
        orientation="v",
        x=0.62,             # Ø£Ù‚Ø±Ø¨ Ø£ÙƒØ«Ø± Ù„Ø¯Ø§Ø®Ù„ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        xanchor="left",
        y=0.98,
        yanchor="top",
        bgcolor="rgba(255,255,255,0.7)",
        bordercolor="black",
        borderwidth=1
    ),
    margin=dict(t=60, l=0, r=0, b=0)
)

fig.show()

"""# 7.  Ø§Ù„Ø®Ø§ØªÙ…Ø© ÙˆØ§Ù„ØªÙˆØµÙŠØ§Øª - Conclusion & Recommendations

**Ù‚Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø±Ø¤Ù‰ Ø£Ø³Ø§Ø³ÙŠØ© Ø­ÙˆÙ„ Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ© ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ØŒ Ù…Ø¨Ø±Ø²Ù‹Ø§:**
* Ø§Ø±ØªØ¨Ø§Ø·Ù‹Ø§ Ù…Ø¨Ø§Ø´Ø±Ù‹Ø§ Ø¨ÙŠÙ† Ø§Ù„ØªÙˆØªØ± ÙˆØ§Ù„Ø¥Ø±Ù‡Ø§Ù‚.
* Ø£Ù‡Ù…ÙŠØ© Ø¯Ø¹Ù… Ø§Ù„Ù…Ø¯ÙŠØ± ÙˆØ§Ù„Ù†Ù…Ùˆ Ø§Ù„Ù…Ù‡Ù†ÙŠ Ù„Ù„Ø±Ø¶Ø§ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ.
* ØªØ¨Ø§ÙŠÙ† Ø§Ù„Ø±Ø¶Ø§ Ø±ØºÙ… Ø§Ù„Ø¥Ø±Ù‡Ø§Ù‚ Ø§Ù„Ø´Ø¯ÙŠØ¯ØŒ ÙˆØªØ£Ø«ÙŠØ± Ø§Ù„Ø³Ù…Ø§Øª Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ©.
* Ø§Ø®ØªÙ„Ø§Ù Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø¥Ø±Ù‡Ø§Ù‚ ÙˆØªÙˆØ§Ø²Ù† Ø§Ù„Ø¹Ù…Ù„/Ø§Ù„Ø­ÙŠØ§Ø© Ø¨ÙŠÙ† Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ÙˆØ§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ©.

**Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„ÙŠÙ‡ØŒ Ù†ÙˆØµÙŠ Ø¨Ù€:**
1.  Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØªÙˆØªØ± ÙˆØ§Ù„Ø¥Ø±Ù‡Ø§Ù‚ Ø¨ÙØ§Ø¹Ù„ÙŠØ©.
2.  ØªØ¹Ø²ÙŠØ² Ø¯Ø¹Ù… Ø§Ù„Ù…Ø¯ÙŠØ±ÙŠÙ† ÙˆÙ…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù†Ù…Ùˆ.
3.  ØªØ­Ø³ÙŠÙ† Ø¨ÙŠØ¦Ø§Øª Ø§Ù„Ø¹Ù…Ù„ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¶ØºØ·.
4.  ÙÙ‡Ù… Ø¹ÙˆØ§Ù…Ù„ Ø§Ù„Ø±Ø¶Ø§ Ø§Ù„ØªÙŠ ØªÙˆØ§Ø²Ù† Ø§Ù„Ø¥Ø±Ù‡Ø§Ù‚.
5.  ØªØ®ØµÙŠØµ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„Ø¯Ø¹Ù… Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆÙ„.

**Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©: ØªØ­Ù„ÙŠÙ„ Ø£Ø¹Ù…Ù‚ Ù„Ø¨Ù†Ø§Ø¡ Ù†Ù…Ø§Ø°Ø¬ ØªÙ†Ø¨Ø¤ÙŠØ©.**
"""